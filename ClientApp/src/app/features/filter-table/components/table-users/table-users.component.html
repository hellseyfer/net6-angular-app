<div class="card">
  <h3>Users table</h3>
  <p-table
    [value]="users"
    [lazy]="true"
    (onLazyLoad)="loadUsers($event)"
    responsiveLayout="scroll"
    dataKey="id"
    [paginator]="true"
    [rows]="3"
    [globalFilterFields]="['name', 'username', 'email', 'company']"
    [loading]="loading"
    [totalRecords]="10"
    dataKey="id"
  >
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="name">
          Name <p-sortIcon field="name"></p-sortIcon>
        </th>
        <th pSortableColumn="username">
          Username <p-sortIcon field="username"></p-sortIcon>
        </th>
        <th pSortableColumn="company">
          Company <p-sortIcon field="company"></p-sortIcon>
        </th>
      </tr>
      <tr>
        <th>
          <p-columnFilter
            type="text"
            field="name"
            [showMenu]="false"
            [showMatchModes]="false"
            placeholder="nombre completo"
          ></p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            type="text"
            field="username"
            [showMenu]="false"
            [showMatchModes]="false"
          ></p-columnFilter>
        </th>
        <th>
          <p-columnFilter
            type="text"
            field="company"
            [showMenu]="false"
            [showMatchModes]="false"
          ></p-columnFilter>
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData>
      <tr>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="rowData.name"
                (ngModelChange)="onUpdate()"
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ rowData.name }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="rowData.username"
                (ngModelChange)="onUpdate()"
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ rowData.username }}
            </ng-template>
          </p-cellEditor>
        </td>
        <td pEditableColumn>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input
                pInputText
                type="text"
                [(ngModel)]="rowData.company.name"
                (ngModelChange)="onUpdate()"
              />
            </ng-template>
            <ng-template pTemplate="output">
              {{ rowData.company.name }}
            </ng-template>
          </p-cellEditor>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <button
    style="float: right"
    type="button"
    pButton
    pRipple
    icon="pi pi-file-excel"
    (click)="exportExcel()"
    class="p-button-success mr-2"
    pTooltip="XLS"
    tooltipPosition="bottom"
  ></button>
</div>
